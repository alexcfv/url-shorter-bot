[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](./LICENSE)
![Go Version](https://img.shields.io/badge/Language-Go-blue)

#### üìù –ö–æ–º–µ–Ω–Ω—Ç–∞—Ä–∏–π –æ—Ç –∞–≤—Ç–æ—Ä–∞

–≠—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —Ä–∞–±–æ—Ç—É —Å telegram bot api, supabase, cache, http –∏ context.
–í –Ω–µ–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–∞–∫–∏–µ –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—á–∞ telegram_id –≤ context —á–µ—Ä–µ–∑ middleware –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –Ω–∏–º,
–ø—Ä–æ—Å—Ç–æ–π request limiter –∏ —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ —á–µ—Ä–µ–∑ –ø–∞—Ç—Ç–µ—Ä–Ω Dependence Injection (DI)

# üîó URL Shortener Telegram Bot

–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π **Telegram-–±–æ—Ç –¥–ª—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫**, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Go.  
–¢—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å —Å—Å—ã–ª–∫—É ‚Äî –±–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫—É—é. –í—Å—ë –ø—Ä–æ—Å—Ç–æ.

---

## üì≤ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –û—Ç–∫—Ä–æ–π Telegram-–±–æ—Ç–∞.
2. –ù–∞–∂–º–∏ **¬´–°–æ–∫—Ä–∞—Ç–∏—Ç—å —Å—Å—ã–ª–∫—É¬ª**.
3. –û—Ç–ø—Ä–∞–≤—å –ª—é–±—É—é —Å—Å—ã–ª–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://example.com/some/very/long/url`).
4. –ë–æ—Ç –≤–µ—Ä–Ω—ë—Ç –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ "—Ç–≤–æ–π_–ø—Ä–æ—Ç–æ–∫–æ–ª://—Ç–≤–æ–µ_–∏–º—è_—Ö–æ—Å—Ç–∞/—Ö–µ—à_—Å—Å—ã–ª–∫–∏"(–Ω–∞–ø—Ä–∏–º–µ—Ä: `http://short.ly/128429213`).
5. –ü–µ—Ä–µ–π–¥–∏ –ø–æ –Ω–µ–π ‚Äî –∏ –æ–∫–∞–∂–µ—à—å—Å—è –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ.

---

## ‚öôÔ∏è –ü—Ä–µ–¥–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–µ–π–¥–∏ –≤ SQL Editor –∏ –≤—Å—Ç–∞–≤—å —Ç—É–¥–∞ —ç—Ç–æ—Ç –∫–æ–¥

```bash
create or replace function table_exists(tbl text)
returns boolean
language plpgsql
as $$
begin
  return exists (
    select from pg_tables
    where tablename = tbl
  );
end;
$$;

grant execute on function table_exists(text) to service_role;
```

–û–Ω —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ RPC

---

## üöÄ –ó–∞–ø—É—Å–∫

–ë–æ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏: —á–µ—Ä–µ–∑ YAML –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ Docker.

### üîß –í–∞—Ä–∏–∞–Ω—Ç 1: `config.yaml` (–í—Ä—É—á–Ω—É—é)

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `config.yaml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```yaml
host_name: "YOUR_HOST_NAME"         # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: "localhost"
port: "YOUR_PORT"                   # –û–¥–Ω–æ –∏–∑ –¥–≤—É—Ö: "80" (–¥–ª—è HTTP) –∏–ª–∏ "443" (–¥–ª—è HTTPS)
tg_key: "YOUR_TELEGRAM_TOKEN"
db_url: "YOUR_SUPABASE_URL"
db_key: "YOUR_SUPABASE_API_KEY"
```
–ò –∑–∞–ø—É—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é

`/url-shorter-bot`
```bash
go run src/main
```

### üê≥ –í–∞—Ä–∏–∞–Ω—Ç 2: –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç run.sh, –ø–µ—Ä–µ–¥–∞–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

`/url-shorter-bot`
```bash
TG_KEY=your_telegram_token \
DB_URL=https://your-project.supabase.co \
DB_KEY=your_supabase_key \
./run.sh
```
–ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã host_name –∏ port, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

host_name: localhost

port: 80 (–ø—Ä–æ—Ç–æ–∫–æ–ª HTTP)

`/url-shorter-bot`
```bash
TG_KEY=your_telegram_token \
DB_URL=https://your-project.supabase.co \
DB_KEY=your_supabase_key \
HOST_NAME=your_host_name \
PORT=443 \
./run.sh
```

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ä—Ç 443 –∫–æ—Ç–æ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã—Ç —Å–∏—Å—Ç–µ–º–æ–π –¥–ª—è HTTPS –∑–∞–ø—Ä–æ—Å–æ–≤ -> –∏—Å—Ö–æ–¥—è –∏–∑ —ç—Ç–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–µ—à–∞–µ—Ç —á—Ç–æ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å HTTPS

---

### üóÑÔ∏è –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ RLC

| –¢–∞–±–ª–∏—Ü–∞      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                 |
| ------------ | ------------------------------------------ |
| `users`      | –°–ø–∏—Å–æ–∫ Telegram-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π              |
| `urls`       | –•—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –∏ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω—ã—Ö —Å—Å—ã–ª–æ–∫ |
| `log_error`  | –ñ—É—Ä–Ω–∞–ª –æ—à–∏–±–æ–∫                              |
| `log_action` | –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π              |

---

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞–ø–∏—Å–∞–Ω–Ω—ã —Ç–æ–ª—å–∫–æ —é–Ω–∏—Ç —Ç–µ—Å—Ç—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏ end-to-end —Ç–µ—Å—Ç–æ–≤ –Ω–µ—Ç

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

`/url-shorter-bot`
```bash
go test run ./...
```

---

### üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –¢—ã –º–æ–∂–µ—à—å —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –µ–≥–æ.
